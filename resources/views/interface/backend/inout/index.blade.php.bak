@extends('layouts.admin')

@push('plugin-styles')
<link href="{{ asset('/datatables/dataTables.bootstrap4.min.css') }}" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.0/css/dataTables.responsive.css">
<style type="text/css">
  .table thead tr th{
    vertical-align: middle;
    text-align: center;
  }
  .table tbody tr td{
    vertical-align: middle;
    text-align: center;
  }

  #m-datatable th, #m-datatable td {
    font-size: 13px; 
  }
</style>
@endpush
@section('title')
Zakat Fitrah
@endsection
@section('content')
<div class="row">
	<div class="col-sm-12">
		<div class="m-portlet m-portlet--brand">
			<div class="m-portlet__head">
				<div class="m-portlet__head-caption">
					<div class="m-portlet__head-title">
						<h3 class="m-portlet__head-text">
							Data
							<small>
								Masuk Dan Keluar
							</small>
						</h3>
					</div>
				</div>
				<div class="m-portlet__head-tools">
					<a href="{{ url('admin/export/all') }}" class="btn btn-sm btn-success m-btn m-btn--icon m-btn--pill m-btn--air"><i class="fa fa-download"></i> Export Excel All</a>
				</div>
			</div>
			<div class="m-portlet__body">
				<div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
					<div class="row align-items-center">
						<div class="col-xl-8 order-2 order-xl-1">
							<form method="POST" id="filter-list" class="form-inline" role="form">
								<div class="input-group date" data-provide="datepicker" data-date-format="yyyy-mm-dd">
								    <input type="text" class="form-control" name="start" id="start">
								    <div class="input-group-addon">
								        <span class="fa fa-calendar"></span>
								    </div>
								</div>
								S/D
								<div class="input-group date" data-provide="datepicker" data-date-format="yyyy-mm-dd">
								    <input type="text" class="form-control" name="end" id="end">
								    <div class="input-group-addon">
								        <span class="fa fa-calendar"></span>
								    </div>
								</div>
								&nbsp;&nbsp;&nbsp;
								<button class="btn btn-xs btn-outline-accent m-btn m-btn--icon m-btn--icon-only m-btn--outline-2x m-btn--pill m-btn--air" id="search"><i class="fa fa-search"></i></button>
							</form>
						</div>
						<div class="col-xl-4 order-1 order-xl-2 m--align-right">
							
							<form class="form" action="{{ url('admin/export') }}" method="GET">
								{{ csrf_field() }}
								<input type="hidden" name="start" id="p_start">
								<input type="hidden" name="end" id="p_end">
								<button type="submit" class="btn btn-sm btn-outline-brand m-btn m-btn--icon m-btn--outline-2x m-btn--pill m-btn--air"><i class="fa fa-download"></i> Export Excel</button>
							</form>
						</div>
					</div>
				</div>


				<!--begin: Datatable -->
					<table id="m-datatable" class="table table-striped table-hover">
	
					</table>


				<!--end: Datatable -->
				
			</div>
		</div>
	</div>
</div>
@endsection
@push('plugin-scripts')
<script src="{{ asset('/datatables/jquery.dataTables.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('/datatables/dataTables.bootstrap4.min.js') }}" type="text/javascript"></script>
<script type="text/javascript" src="https://cdn.datatables.net/responsive/2.2.0/js/dataTables.responsive.js"></script>
<script src="{{ asset('js/jquery.number.min.js') }}" type="text/javascript"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>
<script type="text/javascript">
	 $(document).ready(function () { 
    
       $.fn.dataTable.ext.search.push(
           function (settings, data, dataIndex) {
               var min = $('#start').datepicker("getDate");
               var max = $('#end').datepicker("getDate");
               // need to change str order before making  date obect since it uses a new Date("mm/dd/yyyy") format for short date.
               var d = data[3].split("/");
               var startDate = new Date(d[1]+ "/" +  d[0] +"/" + d[2]);
    
               if (min == null && max == null) { return true; }
               if (min == null && startDate <= max) { return true;}
               if(max == null && startDate >= min) {return true;}
               if (startDate <= max && startDate >= min) { return true; }
               return false;
           }
       );
    
    
       $("#start").datepicker({ onSelect: function () { table.draw(); }, changeMonth: true, changeYear: true , dateFormat:"dd/mm/yy"});
       $("#end").datepicker({ onSelect: function () { table.draw(); }, changeMonth: true, changeYear: true, dateFormat:"dd/mm/yy" });
       var table =	$('#m-datatable').DataTable({
					    responsive: true,
					    processing: true,
					    severSide: true,
					    ajax: '{{ url('/admin/api/history') }}',
					    columns:[
					    { data: 'jenis',name: 'jenis' , title: 'Jenis'},
					    	{ data: 'jumlah', name: 'jumlah' , title: 'Jumlah'},
					    	{ data: 'keterangan',name: 'keterangan' , title: 'Keterangan'},
					    	{ data: 'tanggal',name: 'tanggal' , title: 'Tanggal'},
					    ],
					    aaSorting: []
				    });
    
       
      $('#filter-list').on('submit',function(e) {
			table.draw();
			e.preventDefault();
			$('#p_start').val($('#start').val());
			$('#p_end').val($('#end').val());
	    });
    });
</script>
@endpush